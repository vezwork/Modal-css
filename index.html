<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Title</title>
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="author" content="vez">

    <meta name="robots" content="index, follow">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <meta name="theme-color" content="#BAE">

    <link rel="shortcut icon" href="">
    <link rel="stylesheet" href="assets/style.css">
    <script src="assets/script.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script>
        
        //todo: is bind bad style?
        //preserve display value rather than always changing it to block on show/toggle
        function Modal(el) {
        //el is either a dom node to modal-ify, or a className string.
            
            this.shown = false;
            this.animating = 0; //0 not animating, 1 animating in, 2 animating out
            this.queued = false; //for animation queueing, true if an animation is queued
        
            //initialize dom
            if (typeof el === "object") {
                this.dom = el;
                if (this.dom.style.display == "none") this.shown = false;
            } else {
                this.dom = document.createElement("div");
                this.dom.className = (typeof el === "string")?el:"modal";
                this.dom.style.display = "none";
                document.body.appendChild(this.dom);
            }
        
            this.show = function(content) {
                if (content) this.dom.innerHTML = content;
                this.dom.style.display = "block";
                
                if (this.inAnim) { //if animations are used
                    if (this.animating==0) { //not animating currently
                        if (!this.shown) {
                            this.dom.style.animationName = this.inAnim;
                            this.animating = 1;
                            this.shown = true;
                        } else {
                            this.queued = false;
                        }
                    } else {
                        this.queued = (this.animating==1)?false:true;
                    }
                } else {
                    this.shown = true;
                }
                
                return this;
            }.bind(this);
            
            this.toggle = function() {
                if (this.shown) {
                    this.hide();
                } else {
                    this.show();
                }
                
                return this;
            }.bind(this);
            
            this.hide = function() {
                if (this.outAnim) { //if animations are used
                    if (this.animating==0) { //not animating currently
                        if (this.shown) {
                            this.dom.style.animationName = this.outAnim;
                            this.animating = 2;
                            this.shown = false;
                        } else {
                            this.queued = false;
                        }
                    } else {
                        this.queued = (this.animating==2)?false:true;
                    }
                } else {
                    this.dom.style.display = "none";
                    this.shown = false;
                }
                
                return this;
            }.bind(this);
            
            this.set = function(content) {
                this.dom.innerHTML = content;
                
                return this;
            }.bind(this);
            
            //animation initialization
            this.setAnim = function(inAnim, outAnim) {
            
                if (!this.inAnim) this.dom.addEventListener("animationend", function() {
                    this.dom.style.animationName = "";
                    this.animating = 0;
                    console.log("anim end!", this.shown);
                    
                    if (!this.shown) {
                        this.dom.style.display = "none";
                        if (this.inAnim === this.outAnim) {
                            this.dom.style.animationDirection = "normal";
                        }
                    } else if (this.inAnim === this.outAnim) {
                        this.dom.style.animationDirection = "reverse";
                    }
                    
                    if (this.queued) {
                        this.queued = false;
                        this.toggle();
                    }
                }.bind(this));
            
                if (!inAnim) throw "setAnim requires at least an intro animation name string";
                if (outAnim) {
                    this.inAnim = inAnim;
                    this.outAnim = outAnim;
                } else {
                    this.inAnim = inAnim;
                    this.outAnim = inAnim;
                }
                
                return this;
            }
            
        }
        
        var myModal;
        
        window.onload = function() {
            myModal = new Modal().setAnim("example", "example2").show("dogs all go to heaven");
            myModal.dom.onclick = myModal.hide;
        }
    </script>
    <style>
        .modal {
            display: none;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            
            background: white;
            box-shadow: 0px 3px 6px gray;
            
            padding: 20px;
            
            animation-duration: 1s;
        }
        
        @keyframes example {
            from {opacity: 0; top: 20%;}
            to {opacity: 1;}
        }
        
        @keyframes example2 {
            from {opacity: 1;}
            to {opacity: 0; top: 80%;}
        }
    </style>
 </head>

<body>
    <button onclick="myModal.toggle();">
        toggle
    </button>
    <button onclick="myModal.show();">
        show
    </button>
    <button onclick="myModal.hide();">
        hide
    </button>
    <button onclick="myModal.set('yiiiii');">
        yes
    </button>
</body>
</html>